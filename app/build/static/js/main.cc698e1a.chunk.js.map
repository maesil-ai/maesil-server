{"version":3,"sources":["secret.ts","components/Header.tsx","components/Footer.tsx","components/Title.tsx","components/Loading.tsx","components/Shelf.tsx","pages/Home.tsx","utility/poseCalculator.ts","utility/draw.ts","utility/score.ts","components/Screen.tsx","pages/Exercise.tsx","components/StatView.tsx","pages/Result.tsx","routes/index.tsx","serviceWorker.ts","index.tsx"],"names":["apiAddress","useStyles","makeStyles","theme","createStyles","root","flexGrow","menuButton","marginRight","spacing","title","Header","AppBar","position","Toolbar","to","Footer","Title","id","Loading","loading","spinnerColor","textColor","logoSrc","text","display","flexWrap","overflow","justifyContent","backgroundColor","palette","background","paper","gridList","width","height","transform","fontWeight","titleBar","Shelf","exercises","classes","GridList","className","cellHeight","cols","map","exercise","GridListTile","key","src","thumbUrl","alt","name","GridListTileBar","subtitle","playTime","Home","props","loadExercises","a","axios","get","response","state","shelfDatas","this","then","exerciseData","data","result","push","exercise_id","thumb_url","play_time","setState","filter","shelfs","Fragment","React","Component","defaultConfig","algorithm","model","architecture","multiplier","outputStride","inputResolution","quantBytes","flipPoseHorizontal","multiPose","maxPoseDetections","minPartConfidence","nmsRadius","PoseCalculator","video","config","poseNet","readyToUse","modelInUse","resultPoses","record","load","posenet","getPoseResult","length","poses","estimatePoses","flipHorizontal","decodingMethod","pose","concat","maxDetections","scoreThreshold","allPoses","toTuple","pos","y","x","drawPoint","ctx","r","color","beginPath","arc","Math","PI","fillStyle","fill","drawSegment","ay","ax","by","bx","scale","offsetx","offsety","moveTo","lineTo","lineWidth","strokeStyle","stroke","drawSkeleton","keypoints","minConfidence","adjacentKeyPoints","forEach","drawKeypoints","i","keypoint","score","drawBoundingBox","boundingBox","rect","minX","minY","maxX","maxY","posePoseSimilarity","modelPose","userPose","poseSimilarity","strategy","exerciseScore","scoreMatrix","Array","from","j","startY","startX","scoreSum","diagonalCnt","Screen","canvas","views","viewConfig","drawCanvas","play","drawVideoPose","offset","showVideo","save","translate","videoWidth","drawImage","videoHeight","restore","minPoseConfidence","showPoints","showSkeleton","showBoundingBox","executeEveryFrame","callback","requestAnimationFrame","clearRect","calculator","createRef","finishCount","Object","assign","onended","onExerciseFinish","time","calorie","current","getContext","promises","Promise","all","ref","defaultProps","Exercise","guideVideo","userVideo","loadVideo","video_url","loadStream","navigator","mediaDevices","getUserMedia","audio","facingMode","componentDidMount","guideSource","userStream","srcObject","resolve","cnt","incrementCnt","onloadeddata","isLoading","handleExerciseFinish","console","log","post","code","redirectToResult","catch","error","isFinished","match","params","pathname","exerciseId","videos","crossOrigin","style","StatView","round","Result","method","url","exerciseName","location","stats","Root","exact","path","component","Boolean","window","hostname","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister","message"],"mappings":"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","file":"static/js/main.cc698e1a.chunk.js","sourcesContent":["const apiAddress = 'https://13.209.193.142:8080';\n\nexport default apiAddress;\n","import React from 'react';\n\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport { AppBar, Toolbar, IconButton, Typography, Button } from '@material-ui/core';\nimport { Home } from '@material-ui/icons'\nimport { Link } from 'react-router-dom';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n    },\n    menuButton: {\n      marginRight: theme.spacing(2),\n    },\n    title: {\n      flexGrow: 1,\n    },\n  }),\n);\n\nfunction Header() {\n  const classes = useStyles();\n\n  return (\n    <AppBar position=\"static\">\n      <Toolbar>\n        <Link to='/'><Home/></Link>\n      </Toolbar>\n    </AppBar>\n  );\n}\n\nexport default Header;","import React from 'react';\n\n\n/**\n * Footer HTML 변환\n * @return {any} Footer HTML\n */\nfunction Footer() {\n  return (\n    <footer>\n            © SW마에스트로 11기 코드블루팀\n    </footer>\n  );\n}\n\nexport default Footer;\n","import React from 'react';\n\ninterface TitleProps {\n  title : string,\n};\n\n/**\n * 타이틀 컴포넌트 결과창 위에 있는 타이틀\n * @param {TitleProps} {title}\n * @return {HTML} title div\n */\nfunction Title({title} : TitleProps) {\n  return (\n    <div id={'title'} >\n      { title }\n    </div>\n  );\n}\n\nexport default Title;\n","import React from 'react';\n\nimport LoadingScreen from 'react-loading-screen'\n\n\nfunction Loading() {\n  return (\n    <LoadingScreen\n        loading={true}\n        spinnerColor='#9ee5f8'\n        textColor='#676767'\n        logoSrc='http://www.foodnmed.com/news/photo/201903/18296_3834_4319.jpg'\n        text=\"불러오는 중...\"\n    />\n  );\n}\n\nexport default Loading;\n","import React from 'react';\nimport { Theme, createStyles, makeStyles } from '@material-ui/core/styles';\nimport { GridList, GridListTile, GridListTileBar } from '@material-ui/core';\nimport { Link } from 'react-router-dom';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexWrap: 'nowrap',\n      overflow: 'auto',\n      justifyContent: 'flex-start',\n      backgroundColor: theme.palette.background.paper,\n    },\n    gridList: {\n      width: 350,\n      height: 350,\n      flexWrap: 'nowrap',\n      display: 'inline-block',\n      // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n      transform: 'translateZ(0)',\n    },\n    title: {\n      fontWeight: 700,\n    },\n    titleBar: {\n      background:\n        'rgba(100, 100, 100, 0.54)',\n    },\n  }),\n);\n\nexport interface Exercise {\n    id : number,\n    name : string,\n    thumbUrl : string,\n    playTime : string,\n};\n\ninterface ShelfProps {\n  exercises : Exercise[],\n};\n\nfunction Shelf({exercises} : ShelfProps) {\n    const classes = useStyles();\n\n    return (\n      <GridList className={classes.root} cellHeight={300} cols={5.5}>\n        { exercises.map((exercise) => (\n          <GridListTile key={exercise.id} className={classes.gridList}>\n              <Link to={'/exercise/' + exercise.id}>\n                  <img src={exercise.thumbUrl} alt={exercise.name} width={300} />\n              </Link>\n              <GridListTileBar\n                title={exercise.name}\n                subtitle={exercise.playTime}\n                classes={{\n                  root: classes.titleBar,\n                  title: classes.title,\n                }}\n              />\n          </GridListTile>\n        )) }\n      </GridList>\n    );\n}\n\nexport default Shelf;\n","import apiAddress from '../secret';\n\n// @ts-ignore\nimport axios from 'axios';\nimport React from 'react';\n\nimport Header from '../components/Header';\nimport Footer from '../components/Footer';\nimport Title from '../components/Title';\nimport Loading from '../components/Loading';\nimport Shelf, { Exercise } from '../components/Shelf';\n\ninterface ShelfData {\n  title: string,\n  exercises: Exercise[],\n};\n\ninterface HomeProps {\n\n};\n\ninterface HomeState {\n    shelfDatas: ShelfData[],\n    loading: boolean,\n};\n\n/**\n * 홈 클래스 (메인 화면, 추천 화면 담당) 페이지\n * @param {any} event\n * @class Home\n * @extends {React.Component<HomeProps, HomeState>}\n */\nclass Home extends React.Component<HomeProps, HomeState> {\n  /**\n   * Creates an instance of Home.\n   * @param {HomeProps} props\n   * @memberof Home\n   */\n  constructor(props : HomeProps) {\n    super(props);\n    this.state = {\n      shelfDatas: [],\n      loading: true,\n    };\n  }\n\n  loadExercises = async () => {\n    let response = await axios.get(\n        apiAddress + '/exercises/',\n    );\n    return response;\n  }\n\n  /**\n   * 기본 함수\n   * @memberof Home\n   */\n  componentDidMount() {\n    this.loadExercises().then((response) => {\n      const exerciseData = response.data.result;\n      const exercises : Exercise[] = [];\n      for (const exercise of exerciseData) {\n        exercises.push({\n          id: exercise.exercise_id,\n          name: exercise.title,\n          thumbUrl: exercise.thumb_url ? exercise.thumb_url : 'http://www.foodnmed.com/news/photo/201903/18296_3834_4319.jpg',\n          playTime: exercise.play_time,\n        });\n      }\n      this.setState({\n        ...this.state,\n        shelfDatas: [\n          {\n            title: \"그냥... 모든 운동들\",\n            exercises: exercises,\n          }, {\n            title: \"첫글자 P로 시작하는 운동들!\",\n            exercises: exercises.filter((exercise) => { return (exercise.name[0] === 'p' || exercise.name[0] === 'P'); })\n          }\n        ],\n        loading: false,\n      });\n    });\n  }\n\n  render() {\n  if (this.state.loading) return (\n    <>\n      <Header/>\n      <Loading/>\n      <Footer/>\n    </>\n  );\n  else {\n    const shelfs = this.state.shelfDatas.map((data) => (\n      <React.Fragment key={data.title}>\n        <Title title = { data.title }/>\n        <Shelf exercises = { data.exercises }/>\n      </React.Fragment>\n    ))\n    return (\n      <>\n        <Header/>\n        { shelfs }\n        <Footer/>\n      </>\n    );\n  }\n}\n\n};\n\nexport default Home;\n","import * as posenet from '@tensorflow-models/posenet';\n\ninterface Config {\n    algorithm: string,\n    model: posenet.ModelConfig,\n    flipPoseHorizontal: boolean,\n    multiPose: {\n        maxPoseDetections: number,\n        minPartConfidence: number,\n        nmsRadius: number,\n    }\n};\n\nconst defaultConfig : Config = {\n  algorithm: 'single-pose',\n  model: {\n    architecture: 'MobileNetV1',\n    multiplier: 0.75, // isMobile() ? 0.5 : 0.75,\n    outputStride: 16,\n    inputResolution: 250,\n    quantBytes: 2,\n  },\n  flipPoseHorizontal: false,\n  multiPose: {\n    maxPoseDetections: 5,\n    minPartConfidence: 0.1,\n    nmsRadius: 30.0,\n  },\n};\n\nexport type Pose = posenet.Pose;\n\n// const defaultResNetMultiplier = 1.0;\n// const defaultResNetStride = 32;\n// const defaultResNetInputResolution = 250;\n\n/**\n * PoseCalculator 클래스\n * @class PoseCalculator\n */\nclass PoseCalculator {\n    video : HTMLVideoElement;\n    poseNet : posenet.PoseNet;\n    config : Config;\n    readyToUse : boolean;\n    modelInUse : boolean;\n    resultPoses : posenet.Pose[];\n    record : posenet.Pose[];\n\n    /**\n     * Creates an instance of PoseCalculator.\n     * @param {HTMLVideoElement} video\n     * @param {*} [config=defaultConfig]\n     * @memberof PoseCalculator\n     */\n    constructor(video : HTMLVideoElement, config = defaultConfig) {\n      this.video = video;\n      this.config = config;\n      this.modelInUse = true;\n      this.readyToUse = false;\n      this.resultPoses = [];\n      this.record = [];\n    }\n\n    load = async () => {\n      const poseNet = await posenet.load(this.config.model);\n      this.poseNet = poseNet;\n      this.modelInUse = false;\n      this.readyToUse = true;\n    }\n\n    // 기존의 applyPosenetChange는 'on...Change'식의 함수로 사용할 것.\n\n    getPoseResult = async () => {\n      if (this.modelInUse) {\n        if (this.record.length > 0) this.record.push(this.record[this.record.length-1]);\n        return false;\n      }\n\n      this.modelInUse = true;\n\n      let poses : posenet.Pose[] = [];\n\n      switch (this.config.algorithm) {\n        case 'single-pose':\n          const pose = await this.poseNet.estimatePoses(this.video, {\n            flipHorizontal: this.config.flipPoseHorizontal,\n            decodingMethod: 'single-person',\n          });\n          poses = poses.concat(pose);\n          break;\n\n        case 'multi-pose':\n          const allPoses = await this.poseNet.estimatePoses(this.video, {\n            flipHorizontal: this.config.flipPoseHorizontal,\n            decodingMethod: 'multi-person',\n            maxDetections: this.config.multiPose.maxPoseDetections,\n            scoreThreshold: this.config.multiPose.minPartConfidence,\n            nmsRadius: this.config.multiPose.nmsRadius,\n          });\n\n          poses = poses.concat(allPoses);\n          break;\n      }\n\n      if (poses[0]) this.record.push(poses[0]);\n\n      this.resultPoses = poses;\n      this.modelInUse = false;\n\n      return true;\n    }\n};\n\nexport default PoseCalculator;\n","/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Modifications copyright (C) 2020 Maesil.AI\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n\nimport * as posenet from '@tensorflow-models/posenet';\nimport * as tf from '@tensorflow/tfjs';\n\nconst color = 'aqua';\nconst boundingBoxColor = 'red';\nconst lineWidth = 1;\n\n/**\n * 접속한 기기가 Android인지 판단\n * @return {boolean} Android면 true 반환\n */\nfunction isAndroid() {\n  return /Android/i.test(navigator.userAgent);\n}\n\n/**\n * 접속한 기기가 iOS인지 판단\n * @return {boolean} iOS면 true 반환\n */\nfunction isiOS() {\n  return /iPhone|iPad|iPod/i.test(navigator.userAgent);\n}\n\n/**\n * 접속한 기기가 모바일인지 판단\n * @export\n * @return {boolean} 모바일이면 true 반환\n */\nexport function isMobile() {\n  return isAndroid() || isiOS();\n}\n\n/**\n * pos를 받아서 튜블로 변환\n * @param {*} pos\n * @return {[number, number]}\n */\nfunction toTuple(pos : any) : [number, number] {\n  return [pos.y, pos.x];\n}\n\n/**\n * 주어진 keypoint를 점으로 찍어주는 함수\n * @export\n * @param {*} ctx 캔버스\n * @param {*} y y\n * @param {*} x x\n * @param {*} r r\n * @param {*} color color\n */\nexport function drawPoint(ctx, y, x, r, color) {\n  ctx.beginPath();\n  ctx.arc(x, y, r, 0, 2 * Math.PI);\n  ctx.fillStyle = color;\n  ctx.fill();\n}\n\n/**\n * 주어진 점을 바탕으로 키포인트를 이어 캔버스에 선을 그려주는 함수(관절)\n * @export\n * @param {*} ay ay\n * @param {*} by by\n * @param {any} color 색\n * @param {any} ctx 캔버스\n * @param {number} [scale=1] 크기\n * @param {any} offsetx 시작 x\n * @param {any} offsety 시작 y\n */\nexport function drawSegment(\n    [ay, ax],\n    [by, bx],\n    color,\n    ctx,\n    scale = 1,\n    [offsetx, offsety] = [0, 0],\n) {\n  ctx.beginPath();\n  ctx.moveTo(ax * scale + offsetx, ay * scale + offsety);\n  ctx.lineTo(bx * scale + offsetx, by * scale + offsety);\n  ctx.lineWidth = lineWidth;\n  ctx.strokeStyle = color;\n  ctx.stroke();\n}\n\n/**\n * Draws a pose skeleton by looking up all adjacent keypoints/joints\n * @export\n * @param {posenet.Keypoint[]} keypoints\n * @param {number} minConfidence\n * @param {CanvasRenderingContext2D} ctx\n * @param {number} [scale=1]\n * @param {*} offsetx\n * @param {*} offsety\n */\nexport function drawSkeleton(\n    keypoints: posenet.Keypoint[],\n    minConfidence: number,\n    ctx: CanvasRenderingContext2D,\n    scale = 1,\n    [offsetx, offsety] = [0, 0],\n) {\n  const adjacentKeyPoints = posenet.getAdjacentKeyPoints(\n      keypoints,\n      minConfidence,\n  );\n\n  adjacentKeyPoints.forEach((keypoints) => drawSegment(\n      toTuple(keypoints[0].position),\n      toTuple(keypoints[1].position),\n      color,\n      ctx,\n      scale,\n      [offsetx, offsety]),\n  );\n}\n\n/**\n * Draw pose keypoints onto a canvas\n * @export\n * @param {posenet.Keypoint[]} keypoints\n * @param {number} minConfidence\n * @param {CanvasRenderingContext2D} ctx\n * @param {number} [scale=1]\n * @param {*} offsetx default=0\n * @param {*} offsety default=0\n */\nexport function drawKeypoints(\n    keypoints: posenet.Keypoint[],\n    minConfidence: number,\n    ctx: CanvasRenderingContext2D,\n    scale = 1,\n    [offsetx, offsety] = [0, 0],\n) {\n  for (let i = 0; i < keypoints.length; i++) {\n    const keypoint = keypoints[i];\n\n    if (keypoint.score < minConfidence) {\n      continue;\n    }\n\n    const {y, x} = keypoint.position;\n    drawPoint(ctx, y * scale + offsety, x * scale + offsetx, 3, color);\n  }\n}\n\n/**\n * Draw the bounding box of a pose. For example, for a whole person standing\n * in an image, the bounding box will begin at the nose and extend to one of\n * ankles\n * @export\n * @param {posenet.Keypoint[]} keypoints\n * @param {CanvasRenderingContext2D} ctx\n * @param {number} [scale=1]\n * @param {*} offsetx default=0\n * @param {*} offsety default=0\n */\nexport function drawBoundingBox(\n    keypoints: posenet.Keypoint[],\n    ctx: CanvasRenderingContext2D,\n    scale = 1,\n    [offsetx, offsety] = [0, 0],\n) {\n  const boundingBox = posenet.getBoundingBox(keypoints);\n\n  ctx.rect(\n      scale * boundingBox.minX + offsetx,\n      scale * boundingBox.minY + offsety,\n      scale * (boundingBox.maxX - boundingBox.minX),\n      scale * (boundingBox.maxY - boundingBox.minY),\n  );\n\n  ctx.strokeStyle = boundingBoxColor;\n  ctx.stroke();\n}\n/**\n * Converts an arary of pixel data into an ImageData object\n * @export\n * @param {*} a\n * @param {*} ctx\n */\nexport async function renderToCanvas(a, ctx) {\n  const [height, width] = a.shape;\n  const imageData = new ImageData(width, height);\n\n  const data = await a.data();\n\n  for (let i = 0; i < height * width; ++i) {\n    const j = i * 4;\n    const k = i * 3;\n\n    imageData.data[j + 0] = data[k + 0];\n    imageData.data[j + 1] = data[k + 1];\n    imageData.data[j + 2] = data[k + 2];\n    imageData.data[j + 3] = 255;\n  }\n\n  ctx.putImageData(imageData, 0, 0);\n}\n\n/**\n * Draw an image on a canvas\n * @export\n * @param {*} image\n * @param {*} size\n * @param {*} canvas\n */\nexport function renderImageToCanvas(image, size, canvas) {\n  canvas.width = size[0];\n  canvas.height = size[1];\n  const ctx = canvas.getContext('2d');\n\n  ctx.drawImage(image, 0, 0);\n}\n\n/**\n * Draw heatmap values, one of the model outputs, on to the canvas\n * Read our blog post for a description of PoseNet's heatmap outputs\n * https://medium.com/tensorflow/real-time-human-pose-estimation-in-the-browser-with-tensorflow-js-7dd0bc881cd5\n * @export\n * @param {*} heatMapValues\n * @param {*} outputStride\n * @param {*} canvas\n */\nexport function drawHeatMapValues(heatMapValues, outputStride, canvas) {\n  const ctx = canvas.getContext('2d');\n  const radius = 5;\n  const scaledValues = heatMapValues.mul(tf.scalar(outputStride, 'int32'));\n\n  drawPoints(ctx, scaledValues, radius, color);\n}\n\n/**\n * Used by the drawHeatMapValues method to draw heatmap points on to\n * the canvas\n * @param {*} ctx\n * @param {*} points\n * @param {*} radius\n * @param {*} color\n */\nfunction drawPoints(ctx, points, radius, color) {\n  const data = points.buffer().values;\n\n  for (let i = 0; i < data.length; i += 2) {\n    const pointY = data[i];\n    const pointX = data[i + 1];\n\n    if (pointX !== 0 && pointY !== 0) {\n      ctx.beginPath();\n      ctx.arc(pointX, pointY, radius, 0, 2 * Math.PI);\n      ctx.fillStyle = color;\n      ctx.fill();\n    }\n  }\n}\n","import {poseSimilarity} from 'posenet-similarity';\nimport * as posenet from '@tensorflow-models/posenet';\n/**\n * view에서 포즈를 추출하는 함수\n * @export\n * @param {*} view\n * @return {*} pose\n */\nexport function extractPose(view) {\n  if (!view || !view.poses || !view.poses.poses) return null;\n  // if (!view.poses.hasOwnProperty('poses')) return null;\n  if (view.poses.poses.length > 1) {\n    console.log('multi person detected');\n    return null;\n  }\n  return view.poses.poses[0];\n}\n\n/**\n * 두 프레임을 받아서 유사도를 리턴\n * @export\n * @param {*} modelPose 모델 포즈\n * @param {*} userPose 유저 포즈\n * @return {*} score 유사도\n */\nexport function posePoseSimilarity(modelPose, userPose) {\n  // 0일수록 비슷 아마 1넘어가기 힘들듯?\n  return poseSimilarity(modelPose, userPose, {strategy: 'weightedDistance'});\n  // 0일수록 비슷 0~2사이 값\n  // return poseSimilarity(modelPose, userPose, {strategy: \"cosineDistance\"});\n  // -1~1 사이 값, -1이면 방향 완전 반대, 1이면 완전 똑같음\n  // return poseSimilarity(modelPose, userPose, {strategy: \"cosineSimilarity\"});\n}\n\n/**\n *  views를 받아서 현재 프레임의 점수를 계산\n * @export\n * @param {*} views Screen.views (view[])\n * @return {*} 포즈 정확도 -1: 현재 모델이 제대로 측정 안됨, 0~1 값 점수\n */\nexport async function scorePoseSimilarity(views) {\n  if (views.length !== 2) return -1;\n  const modelPose= extractPose(views[0]);\n  const userPose = extractPose(views[1]);\n  if (modelPose == null) return -1;\n  if (userPose == null) return 0;\n\n  return posePoseSimilarity(modelPose, userPose);\n}\n\n/**\n * modelPose와 userPose의 배열을 받이서 전체 운동에 대한 점수를 return\n * @export\n * @param {*} modelPose posenet.Pose[],\n * @param {*} userPose posenet.Pose[]\n * @return {*} score\n */\nexport function exerciseScore(modelPose: posenet.Pose[],\n    userPose: posenet.Pose[]) {\n  let score = 0;\n\n  const scoreMatrix = Array.from(Array(modelPose.length),\n      () => new Array(userPose.length));\n\n  const minimumCoverage = 0.7;\n  for (let i = 0; i < modelPose.length; i++) {\n    for (let j = 0; j < userPose.length; j++) {\n      scoreMatrix[i][j] = posePoseSimilarity(modelPose[i], userPose[j]);\n    }\n  }\n\n  // 대각선으로 보면서 평균 Sim이 제일 높은 얘를 찾음\n  let startY = modelPose.length - 1;\n  let startX = 0;\n  for (; startX < userPose.length; (startY > 0 ? startY-- : startX++)) {\n    let x = startX;\n    let y = startY;\n    let scoreSum = 0;\n    const diagonalCnt = modelPose.length - startY;\n    if (diagonalCnt / (modelPose.length) < minimumCoverage) {\n      continue;\n    }\n\n    for (; y < modelPose.length; y++, x++) {\n      scoreSum += scoreMatrix[y][x];\n    }\n    if (score < scoreSum / diagonalCnt) {\n      score = scoreSum / diagonalCnt;\n    }\n  }\n  return score;\n}\n","import React from 'react';\nimport PoseCalculator, { Pose } from '../utility/poseCalculator';\nimport {\n  drawBoundingBox,\n  drawKeypoints,\n  drawSkeleton,\n} from '../utility/draw';\nimport { exerciseScore } from '../utility/score';\n\ninterface View {\n    video: HTMLVideoElement,\n    scale: number,\n    offset: [number, number],\n    calculator?: PoseCalculator,\n};\n\ninterface ViewConfig {\n  flipPoseHorizontal: boolean,\n  showVideo: boolean,\n  showSkeleton: boolean,\n  showPoints: boolean,\n  showBoundingBox: boolean,\n  minPoseConfidence: number,\n  minPartConfidence: number,\n};\n\nconst defaultViewConfig = {\n  flipPoseHorizontal: false,\n  showVideo: true,\n  showSkeleton: true,\n  showPoints: true,\n  showBoundingBox: true,\n  minPoseConfidence: 0.15,\n  minPartConfidence: 0.1,\n};\n\ninterface ScreenProps {\n    videoWidth: number,\n    videoHeight: number,\n    views: View[],\n    viewConfig: ViewConfig,\n    onExerciseFinish: (record: any) => any,\n    match?: any,\n};\n\ninterface ScreenState {\n  finishCount: number,\n};\n\n\n/**\n * Screen 클래스\n * 운동하고 있는 화면을 보여주는 스크린\n * @class Screen\n * @extends {React.Component<ScreenProps, ScreenState>}\n */\nclass Screen extends React.Component<ScreenProps, ScreenState> {\n    static defaultProps : ScreenProps = {\n      videoWidth: 800,\n      videoHeight: 600,\n      views: [],\n      onExerciseFinish: () => {},\n      viewConfig: defaultViewConfig,\n    };\n\n    ctx: CanvasRenderingContext2D;\n    canvas: React.RefObject<HTMLCanvasElement>;\n    views: View[];\n    viewConfig: ViewConfig;\n\n    /**\n     * Creates an instance of Screen.\n     * @param {ScreenProps} props\n     * @memberof Screen\n     */\n    constructor(props: ScreenProps) {\n      super(props);\n\n      this.canvas = React.createRef<HTMLCanvasElement>();\n      this.viewConfig = this.props.viewConfig;\n      this.views = this.props.views;\n      this.state = {\n        finishCount: 0,\n      };\n\n      for (let i=0; i<this.views.length; i++) {\n        Object.assign(this.views[i], {\n          calculator: new PoseCalculator(this.views[i].video),\n        });\n\n        this.views[i].video.onended = () => {\n          let finishCount = this.state.finishCount + 1;\n          this.setState({\n            finishCount: finishCount,\n          });\n\n          if (finishCount === 1) {\n            this.props.onExerciseFinish({\n              score: exerciseScore(this.views[0].calculator.record, this.views[1].calculator.record),\n              time: 63*60,\n              calorie: 1021,\n            });\n          }\n        }\n      }\n    }\n\n    /**\n     * 리액트 컴포넌트 클래스 기본 함수\n     * @memberof Screen\n     */\n    componentDidMount() {\n      this.ctx = this.canvas.current!.getContext('2d')!;\n      let promises : Promise<void>[] = [];\n      for (let i=0; i<this.views.length; i++) {\n        promises.push(this.views[i].calculator.load());\n      }\n\n      Promise.all(promises).then(() => {\n        this.drawCanvas();\n      });\n    }\n\n    drawCanvas = () => {\n      const ctx = this.ctx!;\n\n      for (let i=0; i<this.views.length; i++) {\n        this.views[i].video.play();\n      }\n\n      const drawVideoPose = (video: CanvasImageSource, poses: Pose[], scale = 1,\n          offset: [number, number] = [0, 0]) => {\n        const ctx = this.ctx!;\n\n        if (this.viewConfig.showVideo) {\n          ctx.save();\n          ctx.translate(this.viewConfig.flipPoseHorizontal ?\n            (scale * this.props.videoWidth) : 0, 0);\n          ctx.scale(this.viewConfig.flipPoseHorizontal ? -1 : 1, 1);\n          ctx.drawImage(\n              video,\n              (this.viewConfig.flipPoseHorizontal ? -1 : 1) * offset[0],\n              offset[1],\n              this.props.videoWidth * scale,\n              this.props.videoHeight * scale,\n          );\n          ctx.restore();\n        }\n\n        if (poses) {\n          poses.forEach(({score, keypoints}) => {\n            if (score >= this.viewConfig.minPoseConfidence) {\n              if (this.viewConfig.showPoints) {\n                drawKeypoints(keypoints,\n                    this.viewConfig.minPartConfidence, ctx, scale, offset);\n              }\n              if (this.viewConfig.showSkeleton) {\n                drawSkeleton(keypoints,\n                    this.viewConfig.minPartConfidence, ctx, scale, offset);\n              }\n              if (this.viewConfig.showBoundingBox) {\n                drawBoundingBox(keypoints, ctx, scale, offset);\n              }\n            }\n          });\n        }\n      };\n\n      /**\n       * 매 프레임 마다 다시 콜백으로 자기를 불러서 무한반복으로 실행\n       * @param {*} callback 자기자신\n       */\n      function executeEveryFrame(callback) {\n        //            stats.begin();\n        callback();\n        //            stats.end();\n\n        requestAnimationFrame(() => {\n          executeEveryFrame(callback);\n        });\n      }\n\n      executeEveryFrame(() => {\n        ctx.clearRect(0, 0, this.props.videoWidth, this.props.videoHeight);\n        for (let i = 0; i < this.views.length; i++) {\n          this.views[i].calculator.getPoseResult();\n          drawVideoPose(this.views[i].video,\n              this.views[i].calculator.resultPoses,\n              this.views[i].scale,\n              this.views[i].offset);\n        }\n      });\n    }\n\n    /**\n     * 직접 실행할일은 없음, 지원하지 않을때는 뜨는 함수\n     * @return {any} HTML 반환\n     * @memberof Screen\n     */\n    render() {\n      return (\n        <div>\n          <canvas\n            ref={this.canvas}\n            width={this.props.videoWidth}\n            height={this.props.videoHeight}\n          >\n            운동 기능이 지원되지 않는 브라우저입니다..ㅠㅠ\n          </canvas>\n        </div>\n      );\n    }\n}\n\n\nexport default Screen;\n","import apiAddress from '../secret';\n\n// @ts-ignore\nimport axios from 'axios';\nimport React from 'react';\nimport Screen from '../components/Screen';\nimport Header from '../components/Header';\nimport Footer from '../components/Footer';\nimport Loading from '../components/Loading';\nimport {Redirect} from 'react-router-dom';\n\ninterface ExerciseProps {\n  videoWidth: number,\n  videoHeight: number,\n  match?: any,\n  history?: any,\n};\n\ninterface Record {\n  score: number,\n  playTime: number,\n  calorie: number,\n};\n\ninterface ExerciseState {\n  isLoading: boolean,\n  isFinished: boolean,\n  redirectToResult: boolean,\n\n  id: number,\n\n  record: Record | null,\n\n  url?: string,\n};\n\n/**\n * 시간(숫자)을 string으로 변환하는 함수\n * @param {number} time\n * @return {string} 시간을 DB에 저장하기 좋게 string으로 변환\n */\n// function timeToString(time : number) {\n//   const sec0 = time % 10;\n//   time = (time - sec0) / 10;\n//   const sec1 = time % 6;\n//   time = (time - sec1) / 6;\n//   const min0 = time % 10;\n//   time = (time - min0) / 10;\n//   const min1 = time % 6;\n//   time = (time - min1) / 6;\n//   const hr0 = time % 10;\n//   time = (time - hr0) / 10;\n//   const hr1 = time % 10;\n\n//   return `${hr1}${hr0}:${min1}${min0}:${sec1}${sec0}`;\n// }\n\n/**\n * Excerciese 페이지\n * @class Exercise\n * @extends {React.Component<ExerciseProps, ExerciseState>}\n */\nclass Exercise extends React.Component<ExerciseProps, ExerciseState> {\n  guideVideo = React.createRef<HTMLVideoElement>();\n  userVideo = React.createRef<HTMLVideoElement>();\n  \n  static defaultProps = {\n    videoWidth: 800,\n    videoHeight: 600,\n  };\n\n  /**\n   * Creates an instance of Exercise.\n   * @param {ExerciseProps} props\n   * @memberof Exercise\n   */\n  constructor(props : ExerciseProps) {\n    super(props);\n\n    this.state = {\n      isLoading: true,\n      isFinished: false,\n      redirectToResult: false,\n      id: props.match.params.id,\n      record: null,\n    };\n  }\n\n\n  /**\n   * id로 서버에 비디오를 요청해서 url을 받아옴\n   * @param {number} id\n   * @return {*} 비디오의 url\n   */\n  loadVideo = async (id : number) => {\n    const response = await axios.get(apiAddress + '/exercises/' + id);\n    return response.data.result.video_url;\n  }\n\n  loadStream = async () => {\n    return await navigator.mediaDevices.getUserMedia({\n      audio: false,\n      video: {\n        facingMode: 'user',\n        width: this.props.videoWidth,\n        height: this.props.videoHeight,\n      },\n    });\n  }\n\n  componentDidMount = () => {\n    const guideSource = this.loadVideo(this.state.id);\n    const userStream = this.loadStream();\n\n    Promise.all([guideSource, userStream]).then(([guideSource, userStream]) => {\n          const guideVideo = this.guideVideo.current!;\n          const userVideo = this.userVideo.current!;\n          guideVideo.src = guideSource;\n          userVideo.srcObject = userStream;\n\n          new Promise((resolve) => {\n            let cnt = 0;\n            const incrementCnt = () => {\n              cnt += 1;\n              if (cnt >= 2) resolve();\n            };\n            guideVideo.onloadeddata = incrementCnt;\n            userVideo.onloadeddata = incrementCnt;\n          }).then(() => this.setState({\n            ...this.state,\n            isLoading: false,\n          }));\n        });\n  };\n\n  handleExerciseFinish = (record: Record) => {\n    console.log(\"HI!!!!\");\n    axios.post(apiAddress + '/exercises/' + this.state.id + '/history', {\n      'score': record.score,\n      'play_time': \"00:01:03\",\n      'cal': record.calorie,\n    }).then((response) => {\n      console.log(response);\n      // response.data.code != 200이면?\n      if (response.data.code === 200) {\n        this.setState({\n          ...this.state,\n          record: record,\n          redirectToResult: true,\n        });\n      } else {\n        console.log('ㅋㅋ..;;');\n      }\n    }).catch((error) => {\n      console.log('ㅋㅋ..ㅈㅅ!!ㅎㅎ..');\n    });\n  }\n\n  /**\n   * 운동 페이지를 렌더링 해서 보여줌\n   * @return {any} 운동 페이지 HTML\n   * @memberof Exercise\n   */\n  render() {\n    if (this.state.redirectToResult) {\n      return <Redirect push to={{\n        pathname: '/result',\n        state: {\n          exerciseId: this.state.id,\n          score: this.state.record.score,\n          time: this.state.record.playTime,\n          calorie: this.state.record.calorie,\n        },\n      }}/>;\n    }\n    const videos = (\n      <div>\n        <video\n          height={this.props.videoHeight}\n          width={this.props.videoWidth}\n          crossOrigin={'anonymous'}\n          style={{display: 'none'}}\n          ref={this.guideVideo}\n        />\n        <video\n          height={this.props.videoHeight}\n          width={this.props.videoWidth}\n          crossOrigin={'anonymous'}\n          style={{display: 'none'}}\n          ref={this.userVideo}\n        />\n      </div>\n    );\n\n    if (this.state.isLoading) {\n      return (\n        <div>\n          <Header/>\n          { videos }\n          <Loading/>\n          <Footer/>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <Header/>\n          { videos }\n          <Screen\n            onExerciseFinish = { this.handleExerciseFinish }\n            videoWidth = { this.props.videoWidth }\n            videoHeight = { this.props.videoHeight }\n            views = {[\n              { // Guide View\n                video: this.guideVideo.current!,\n                scale: 1,\n                offset: [0, 0],\n              },\n              { // User View\n                video: this.userVideo.current!,\n                scale: 0.3,\n                offset: [540, 400],\n              },\n            ]}\n          />\n          <Footer/>\n        </div>\n      );\n    }\n  }\n};\n\nexport default Exercise;\n","import React from 'react';\n\ninterface StatViewProps {\n    time: number,\n    calorie: number,\n    score: number,\n};\n\n/**\n * 결과창 페이지 인자로 보여줄 스탯값을 넘겨주고 예쁘게 출력\n * @param {StatViewProps} {time, calorie, score}\n * @return {any} HTML 페이지\n */\nfunction StatView({time, calorie, score} : StatViewProps) {\n  return (\n    <div className={'boxContainer'}>\n      <div className={'box'}> {(time - time%60) / 60}분 {time%60}초 </div>\n      <div className={'box'}> {Math.round(calorie)}칼로리 소모 </div>\n      <div className={'box'}> {Math.round(score*100)}점 </div>\n    </div>\n  );\n}\n\nStatView.defaultProps = {\n  time: 63,\n  calorie: 0,\n  score: 0,\n};\n\nexport default StatView;\n","import apiAddress from '../secret';\n\n// @ts-ignore\nimport axios from 'axios';\nimport React from 'react';\n\nimport Header from '../components/Header';\nimport Footer from '../components/Footer';\nimport Title from '../components/Title';\nimport StatView from '../components/StatView';\nimport Loading from '../components/Loading';\n\ninterface Stats {\n    time: number,\n    calorie: number,\n    score: number,\n};\n\ninterface ResultProps {\n    exerciseId : number,\n    location: any,\n};\n\ninterface ResultState {\n    loading : boolean,\n    exerciseId : number,\n    exerciseName? : string,\n    stats: Stats,\n};\n\n/**\n * Result 페이지\n * @class Result\n * @extends {React.Component<ResultProps, ResultState>}\n */\nclass Result extends React.Component<ResultProps, ResultState> {\n\n  /**\n   *Creates an instance of Result.\n    * @param {*} props\n    * @memberof Result\n    */\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      loading: true,\n      exerciseId: this.props.location.state.exerciseId,\n      stats: {\n        time: this.props.location.state.time,\n        calorie: this.props.location.state.calorie,\n        score: this.props.location.state.score,\n      },  \n    };\n  }\n\n  componentDidMount = () => {\n    axios({\n      method: 'GET',\n      url: apiAddress + '/exercises/' + this.state.exerciseId,\n    }).then((response) => {\n      const exerciseName = response.data.result.title;\n\n      this.setState({\n        ...this.state,\n        loading: false,\n        exerciseName: exerciseName,\n      });\n    }).catch((error) => {\n      console.log('ㅋㅋ');\n    });\n  }\n\n  /**\n   * result페이지를 렌더링 하는 함순\n   * @return {any} 렌더링 될 HTML\n   * @memberof Result\n   */\n  render() {\n    if (this.state.loading) {\n      return (\n        <>\n          <Header/>\n          <Loading/>\n          <Footer/>\n        </>\n      );\n    } else {\n      let stats = this.state.stats;\n\n      return (\n        <>\n          <Header/>\n          <Title title={ this.state.exerciseName + ' 완료!' } />\n          <StatView time={ stats.time }\n            calorie={ stats.calorie }\n            score={ stats.score } />\n              다음 코스도 추천해 주자~\n          <Footer/>\n        </>\n      );\n    }\n  }\n};\n\nexport default Result;\n","import React from 'react';\nimport Home from '../pages/Home';\nimport Exercise from '../pages/Exercise';\nimport Result from '../pages/Result';\nimport {BrowserRouter, Switch, Route, Redirect} from 'react-router-dom';\n\nconst Root: React.FC = () => (\n  <BrowserRouter>\n    <Switch>\n      <Route exact path=\"/\" component={Home} />\n      <Route path=\"/exercise/:id\" component={Exercise} />\n      <Route path=\"/result\" component={Result} />\n      <Redirect path=\"*\" to=\"/\" />\n    </Switch>\n  </BrowserRouter>\n);\n\nexport default Root;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\n/**\n * register 리액트가 자동으로 만든 함수\n * @export\n * @param {Config} [config]\n */\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n        process.env.PUBLIC_URL,\n        window.location.href,\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost.\n        // Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n              'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\n/**\n * registerValidSW\n * @param {string} swUrl\n * @param {Config} [config]\n */\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n      .register(swUrl)\n      .then((registration) => {\n        registration.onupdatefound = () => {\n          const installingWorker = registration.installing;\n          if (installingWorker == null) {\n            return;\n          }\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n                console.log(\n                    'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n                );\n\n                // Execute callback\n                if (config && config.onUpdate) {\n                  config.onUpdate(registration);\n                }\n              } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n                console.log('Content is cached for offline use.');\n\n                // Execute callback\n                if (config && config.onSuccess) {\n                  config.onSuccess(registration);\n                }\n              }\n            }\n          };\n        };\n      })\n      .catch((error) => {\n        console.error('Error during service worker registration:', error);\n      });\n}\n\n/**\n * checkValidServiceWorker\n * @param {string} swUrl\n * @param {Config} [config]\n */\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: {'Service-Worker': 'script'},\n  })\n      .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n        const contentType = response.headers.get('content-type');\n        if (\n          response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n        ) {\n        // No service worker found. Probably a different app. Reload the page.\n          navigator.serviceWorker.ready.then((registration) => {\n            registration.unregister().then(() => {\n              window.location.reload();\n            });\n          });\n        } else {\n        // Service worker found. Proceed as normal.\n          registerValidSW(swUrl, config);\n        }\n      })\n      .catch(() => {\n        console.log(\n            'No internet connection found. App is running in offline mode.',\n        );\n      });\n}\n\n/**\n * 언레지스터\n * @export\n */\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n        .then((registration) => {\n          registration.unregister();\n        })\n        .catch((error) => {\n          console.error(error.message);\n        });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './style/index.css';\nimport Root from './routes/index';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n    <React.StrictMode>\n      <Root />\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}